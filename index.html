
<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EKS Original - Electrical Ultimate Calc</title>
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/616/616494.png">
    <style>
        :root { --primary: #007AFF; --bg: #f2f2f7; --card: #ffffff; --text: #1c1c1e; --accent: #8e8e93; }
        [data-theme="dark"] { --bg: #000000; --card: #1c1c1e; --text: #ffffff; --accent: #8e8e93; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 30px; }
        .header { background: var(--card); padding: 15px; text-align: center; box-shadow: 0 1px 5px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; display: flex; justify-content: space-between; align-items: center; }
        .tabs { display: flex; overflow-x: auto; background: var(--card); padding: 10px; gap: 8px; border-bottom: 1px solid #ddd; scrollbar-width: none; }
        .tab-btn { padding: 8px 18px; border: none; background: #e5e5ea; border-radius: 15px; cursor: pointer; white-space: nowrap; font-weight: 600; font-size: 13px; }
        .tab-btn.active { background: var(--primary); color: white; }
        .container { padding: 15px; max-width: 650px; margin: auto; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s; }
        .card { background: var(--card); padding: 18px; border-radius: 14px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 15px; }
        h3 { margin: 0 0 15px 0; font-size: 15px; color: var(--primary); border-left: 4px solid var(--primary); padding-left: 10px; }
        label { display: block; margin-bottom: 5px; font-size: 12px; font-weight: 600; }
        input, select { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 8px; background: var(--bg); color: var(--text); box-sizing: border-box; }
        button { width: 100%; padding: 12px; border: none; border-radius: 8px; background: var(--primary); color: white; font-weight: bold; cursor: pointer; }
        .result-box { margin-top: 10px; padding: 15px; background: #007AFF10; border-radius: 10px; text-align: center; color: var(--primary); font-weight: bold; line-height: 1.8; }
        .res-highlight { font-size: 22px; display: block; margin: 5px 0; color: #ff3b30; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div class="header">
    <div style="width:30px"></div>
    <h2 style="font-size: 16px; margin:0;">âš¡ EKS ULTIMATE CALC</h2>
    <div onclick="toggleTheme()" style="cursor:pointer; font-size: 20px;">ðŸŒ“</div>
</div>

<div class="tabs">
    <button class="tab-btn active" onclick="showTab(event, 'load_cable')">Load & Cable</button>
    <button class="tab-btn" onclick="showTab(event, 'ohm_pf')">Ohm & PF</button>
    <button class="tab-btn" onclick="showTab(event, 'energy')">Energy Cost</button>
    <button class="tab-btn" onclick="showTab(event, 'earth_gen')">Earth & Gen</button>
</div>

<div class="container">
    <div id="load_cable" class="tab-content active">
        <div class="card">
            <h3>Load & Breaker Selection</h3>
            <label>System Phase</label>
            <select id="l_ph"><option value="1">Single Phase (230V)</option><option value="3">Three Phase (400V)</option></select>
            <label>Power (Watts)</label>
            <input type="number" id="l_w" placeholder="e.g. 7000">
            <label>Power Factor (CosÏ†)</label>
            <input type="number" id="l_pf" value="0.8">
            <button onclick="calcLoad()">Calculate Load</button>
            <div class="result-box" id="res_load">Load Current: 0 A<br>MCB: -</div>
        </div>

        <div class="card" id="cable_card">
            <h3>Cable Sizing (BS 7671 Reference)</h3>
            <label>Design Current (Ib) - Amps</label>
            <input type="number" id="c_ib" placeholder="Enter Amps">
            <label>Correction Factor (Ca Ã— Cg Ã— Ci)</label>
            <input type="number" id="c_fact" value="1" step="0.01">
            <button onclick="calcCable()">Find Cable Size</button>
            <div class="result-box" id="res_cable">
                It (Required): 0 A<br>
                Recommended Cable:<br>
                <span class="res-highlight" id="res_csize">- mmÂ²</span>
            </div>
            <p style="font-size: 10px; color: grey;">*Based on PVC Insulated Copper Multi-core Cable.</p>
        </div>
    </div>

    <div id="ohm_pf" class="tab-content">
        <div class="card">
            <h3>Ohm's Law</h3>
            <label>Find What?</label>
            <select id="o_type" onchange="updateOhmLabels()">
                <option value="v">Voltage (I Ã— R)</option>
                <option value="i">Current (V / R)</option>
                <option value="r">Resistance (V / I)</option>
            </select>
            <input type="number" id="o_v1" placeholder="Value 1">
            <input type="number" id="o_v2" placeholder="Value 2">
            <button onclick="calcOhm()">Calculate</button>
            <div class="result-box" id="res_ohm">Result: 0</div>
        </div>

        <div class="card">
            <h3>PF Correction (kVAR)</h3>
            <label>kW</label><input type="number" id="pf_kw">
            <label>Original PF</label><input type="number" id="pf_orig" value="0.7">
            <label>Target PF</label><input type="number" id="pf_target" value="0.95">
            <button onclick="calcKVAR()">Calculate</button>
            <div class="result-box" id="res_pf">0 kVAR</div>
        </div>
    </div>

    <div id="energy" class="tab-content">
        <div class="card">
            <h3>Energy Cost</h3>
            <label>Watts</label><input type="number" id="en_w">
            <label>Hours/Day</label><input type="number" id="en_h" value="1">
            <label>Price/Unit (MMK)</label><input type="number" id="en_price" value="150">
            <button onclick="calcEnergy()">Calculate</button>
            <div class="result-box" id="res_en">0 MMK</div>
        </div>
    </div>

    <div id="earth_gen" class="tab-content">
        <div class="card">
            <h3>Earth Rod Resistance</h3>
            <label>Soil Resistivity (Î©-m)</label><input type="number" id="e_sr">
            <button onclick="calcEarth()">Calculate</button>
            <div class="result-box" id="res_earth">0 Î©</div>
        </div>
        <div class="card">
            <h3>Generator Sizing</h3>
            <label>Total kW</label><input type="number" id="g_kw">
            <button onclick="calcGen()">Find kVA</button>
            <div class="result-box" id="res_gen">0 kVA</div>
        </div>
    </div>
</div>

<script>
    function showTab(e, id) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        e.currentTarget.classList.add('active');
    }

    function toggleTheme() {
        document.body.hasAttribute('data-theme') ? document.body.removeAttribute('data-theme') : document.body.setAttribute('data-theme', 'dark');
    }

    function calcLoad() {
        let ph = document.getElementById('l_ph').value;
        let w = parseFloat(document.getElementById('l_w').value) || 0;
        let pf = parseFloat(document.getElementById('l_pf').value) || 0.8;
        let amp = (ph == "1") ? (w/(230*pf)) : (w/(400*1.732*pf));
        let ratings = [6, 10, 16, 20, 25, 32, 40, 50, 63, 80, 100, 125, 160, 200, 250, 400];
        let mcb = ratings.find(r => r > amp) || "-";
        document.getElementById('res_load').innerHTML = `Load Current: ${amp.toFixed(2)} A<br>Recommended MCB: ${mcb}A`;
        document.getElementById('c_ib').value = amp.toFixed(2); // Auto fill into cable sizing
    }

    function calcCable() {
        let ib = parseFloat(document.getElementById('c_ib').value) || 0;
        let f = parseFloat(document.getElementById('c_fact').value) || 1;
        let it = ib / f;

        // BS 7671 Reference Table for PVC Multicore (Enclosed in Conduit)
        // [Size, MaxCurrent]
        const cableTable = [
            [1.5, 14.5], [2.5, 20], [4, 26], [6, 34], [10, 46], 
            [16, 61], [25, 80], [35, 99], [50, 119], [70, 151], 
            [95, 182], [120, 210], [150, 240], [185, 273], [240, 321], [300, 367]
        ];

        let selectedSize = "-";
        for (let i = 0; i < cableTable.length; i++) {
            if (cableTable[i][1] >= it) {
                selectedSize = cableTable[i][0] + " mmÂ²";
                break;
            }
        }
        
        if (it > 367) selectedSize = "Above 300 mmÂ² (Parallel required)";

        document.getElementById('res_cable').innerHTML = `
            It (Required): ${it.toFixed(2)} A<br>
            Recommended Cable:<br>
            <span class="res-highlight">${selectedSize}</span>
        `;
    }

    // Other Functions
    function calcOhm() {
        let type = document.getElementById('o_type').value;
        let v1 = parseFloat(document.getElementById('o_v1')) || 0;
        let v2 = parseFloat(document.getElementById('o_v2')) || 0;
        let res = (type==='v') ? v1*v2 : v1/v2;
        document.getElementById('res_ohm').innerText = "Result: " + res.toFixed(2);
    }

    function calcKVAR() {
        let p = parseFloat(document.getElementById('pf_kw').value) || 0;
        let pf1 = parseFloat(document.getElementById('pf_orig').value) || 0.7;
        let pf2 = parseFloat(document.getElementById('pf_target').value) || 0.95;
        let kvar = p * (Math.tan(Math.acos(pf1)) - Math.tan(Math.acos(pf2)));
        document.getElementById('res_pf').innerText = kvar.toFixed(2) + " kVAR";
    }

    function calcEnergy() {
        let w = parseFloat(document.getElementById('en_w').value) || 0;
        let h = parseFloat(document.getElementById('en_h').value) || 0;
        let p = parseFloat(document.getElementById('en_price').value) || 0;
        let cost = (w * h * 30 / 1000) * p;
        document.getElementById('res_en').innerText = cost.toLocaleString() + " MMK / Month";
    }

    function calcEarth() {
        let p = parseFloat(document.getElementById('e_sr').value) || 0;
        let res = (p / (2 * 3.1415 * 2.4)) * (Math.log((8 * 2.4) / 0.016) - 1);
        document.getElementById('res_earth').innerText = res.toFixed(2) + " Î©";
    }

    function calcGen() {
        let kw = parseFloat(document.getElementById('g_kw').value) || 0;
        document.getElementById('res_gen').innerText = (kw / 0.8 * 1.25).toFixed(2) + " kVA";
    }
</script>
</body>
</html>

