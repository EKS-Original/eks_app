<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EKS Ultimate PRO - Admin Integrated</title>
    <style>
        :root { --primary: #007AFF; --bg: #f2f2f7; --card: #ffffff; --text: #1c1c1e; --accent: #8e8e93; }
        [data-theme="dark"] { --bg: #000000; --card: #1c1c1e; --text: #ffffff; --accent: #8e8e93; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 30px; }
        
        /* Activation Layer */
        #activation-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: var(--bg); display: flex; align-items: center; justify-content: center; z-index: 2000; }
        .activation-card { background: var(--card); padding: 30px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; width: 85%; max-width: 380px; }
        .device-id-box { background: #e5e5ea; padding: 12px; border-radius: 10px; font-family: monospace; font-size: 15px; margin: 15px 0; border: 1px dashed var(--primary); color: var(--primary); cursor: pointer; font-weight: bold; }
        
        #app-content { display: none; }
        .header { background: var(--card); padding: 15px; text-align: center; box-shadow: 0 1px 5px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; }
        .tabs { display: flex; overflow-x: auto; background: var(--card); padding: 10px; gap: 8px; border-bottom: 1px solid #ddd; scrollbar-width: none; }
        .tab-btn { padding: 10px 20px; border: none; background: #e5e5ea; border-radius: 12px; cursor: pointer; white-space: nowrap; font-weight: 600; font-size: 13px; }
        .tab-btn.active { background: var(--primary); color: white; }
        .container { padding: 15px; max-width: 650px; margin: auto; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s; }
        .card { background: var(--card); padding: 20px; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 15px; }
        h3 { margin: 0 0 15px 0; font-size: 14px; color: var(--primary); border-left: 5px solid var(--primary); padding-left: 10px; text-transform: uppercase; }
        label { display: block; margin-bottom: 6px; font-size: 12px; font-weight: 700; }
        input, select { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 10px; background: var(--bg); color: var(--text); box-sizing: border-box; font-size: 14px; }
        button { width: 100%; padding: 14px; border: none; border-radius: 10px; background: var(--primary); color: white; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .result-box { margin-top: 10px; padding: 15px; background: #007AFF15; border-radius: 12px; text-align: center; color: var(--primary); font-weight: bold; border: 1px dashed var(--primary); }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div id="activation-overlay">
    <div class="activation-card">
        <div style="font-size: 50px;">üîí</div>
        <h2 style="margin:10px 0;">EKS PRO ACTIVATION</h2>
        <p style="font-size: 12px; color: var(--accent);">·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·Äõ·Äî·Ä∫ ·Ä°·Ä±·Ä¨·ÄÄ·Ä∫·Äï·Ä´ Device ID ·ÄÄ·Ä≠·ÄØ Copy ·Äö·Ä∞·Åç ·Äù·Äö·Ä∫·Äö·Ä∞·Äë·Ä¨·Ä∏·Äû·Ä±·Ä¨ Page ·Äû·Ä≠·ÄØ·Ä∑ ·Äï·Ä≠·ÄØ·Ä∑·Äï·Ä±·Ä∏·Äï·Ä´·Åã</p>
        <div class="device-id-box" id="display-device-id" onclick="copyID()">Generating ID...</div>
        <input type="text" id="license-key-input" placeholder="License Key ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´">
        <button onclick="activateApp()">Activate Full Access</button>
        <p id="error-msg" style="color:red; font-size: 11px; margin-top:10px; display:none;">‚ùå License Key ·Äô·Äô·Äæ·Äî·Ä∫·ÄÄ·Äî·Ä∫·Äï·Ä´·Åã</p>
    </div>
</div>

<div id="app-content">
    <div class="header">
        <div style="width:30px"></div>
        <h2 style="font-size: 15px; margin:0;">EKS ULTIMATE PRO</h2>
        <div onclick="toggleTheme()" style="cursor:pointer; font-size: 20px;">üåì</div>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="showTab(event, 'ohm_pf')">Ohm & PF</button>
        <button class="tab-btn" onclick="showTab(event, 'load_breaker')">Load & Breaker</button>
        <button class="tab-btn" onclick="showTab(event, 'cable_tab')">Cable & Drop</button>
        <button class="tab-btn" onclick="showTab(event, 'energy_tab')">Energy Cost</button>
        <button class="tab-btn" onclick="showTab(event, 'earth_gen')">Earth & Gen</button>
    </div>

    <div class="container">
        <div id="ohm_pf" class="tab-content active">
            <div class="card">
                <h3>Ohm's Law</h3>
                <select id="o_type"><option value="v">Voltage (I √ó R)</option><option value="i">Current (V / R)</option><option value="r">Resistance (V / I)</option></select>
                <input type="number" id="o_v1" placeholder="Value 1">
                <input type="number" id="o_v2" placeholder="Value 2">
                <button onclick="calcOhm()">Calculate</button>
                <div class="result-box" id="res_ohm">Result: 0</div>
            </div>
            <div class="card">
                <h3>PF Correction (kVAR)</h3>
                <label>Load (kW)</label><input type="number" id="pf_kw">
                <label>Original PF</label><input type="number" id="pf_orig" value="0.75">
                <label>Target PF</label><input type="number" id="pf_target" value="0.95">
                <button onclick="calcKVAR()">Find kVAR</button>
                <div class="result-box" id="res_pf">Required: 0 kVAR</div>
            </div>
        </div>

        <div id="load_breaker" class="tab-content">
            <div class="card">
                <h3>Load Current & MCB</h3>
                <label>Phase</label><select id="l_ph"><option value="1">1 Phase</option><option value="3">3 Phase</option></select>
                <label>Total Watts</label><input type="number" id="l_w" placeholder="Watts">
                <label>Power Factor</label><input type="number" id="l_pf" value="0.8">
                <button onclick="calcLoad()">Calculate</button>
                <div class="result-box" id="res_load">Current: 0 A<br>MCB: -</div>
            </div>
        </div>

        <div id="cable_tab" class="tab-content">
            <div class="card">
                <h3>Cable Sizing (mm¬≤)</h3>
                <label>Current (Ib)</label><input type="number" id="c_ib">
                <label>Correction Factor</label><input type="number" id="c_fact" value="1">
                <button onclick="calcCable()">Find Size</button>
                <div class="result-box" id="res_cable">Size: - mm¬≤</div>
            </div>
            <div class="card">
                <h3>Voltage Drop</h3>
                <label>Distance (M)</label><input type="number" id="v_l">
                <label>Current (A)</label><input type="number" id="v_i">
                <label>mV/A/m</label><input type="number" id="v_mv">
                <button onclick="calcVDrop()">Check Drop</button>
                <div class="result-box" id="res_vdrop">Drop: 0 V</div>
            </div>
        </div>

        <div id="energy_tab" class="tab-content">
            <div class="card">
                <h3>Energy Bill</h3>
                <label>Watts</label><input type="number" id="en_w">
                <label>Hours/Day</label><input type="number" id="en_h" value="10">
                <label>Price/Unit (MMK)</label><input type="number" id="en_price" value="150">
                <button onclick="calcEnergy()">Calculate Cost</button>
                <div class="result-box" id="res_en">0 MMK / Month</div>
            </div>
        </div>

        <div id="earth_gen" class="tab-content">
            <div class="card">
                <h3>Earth & Generator</h3>
                <label>Soil Resistivity (Œ©-m)</label><input type="number" id="e_sr">
                <button onclick="calcEarth()">Earth Œ©</button>
                <div class="result-box" id="res_earth">0 Œ©</div>
                <br>
                <label>Total kW</label><input type="number" id="g_kw">
                <button onclick="calcGen()">Gen kVA</button>
                <div class="result-box" id="res_gen">0 kVA</div>
            </div>
        </div>
    </div>
</div>

<script>
    const SALT = "EKS_ORIGINAL_99";

    // --- ADMIN MODE LOGIC ---
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('admin') === 'true') {
        let devID = prompt("User ·ÄÜ·ÄÆ·ÄÄ·Äõ·Äê·Ä≤·Ä∑ Device ID ·ÄÄ·Ä≠·ÄØ ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´ (·Ä•·Äï·Äô·Ä¨ EKS-XXXX):");
        if(devID) {
            let generatedKey = btoa(devID.trim() + SALT).substring(0, 12).toUpperCase();
            alert("·Äí·ÄÆ User ·Ä°·Äê·ÄΩ·ÄÄ·Ä∫ ·Äï·Ä±·Ä∏·Äõ·Äô·Ää·Ä∑·Ä∫ License Key ·ÄÄ·Äê·Ä±·Ä¨·Ä∑: \n\n" + generatedKey);
        }
    }

    function generateID() {
        let info = navigator.userAgent.length + window.screen.width.toString();
        return "EKS-" + btoa(info).substring(0, 8).toUpperCase();
    }
    const myID = generateID();
    document.getElementById('display-device-id').innerText = myID;

    function activateApp() {
        const input = document.getElementById('license-key-input').value.trim();
        const correctKey = btoa(myID + SALT).substring(0, 12).toUpperCase();
        if(input === correctKey) {
            localStorage.setItem('eks_license_v1', input);
            location.reload();
        } else {
            document.getElementById('error-msg').style.display = 'block';
        }
    }

    window.onload = function() {
        const key = localStorage.getItem('eks_license_v1');
        const correctKey = btoa(myID + SALT).substring(0, 12).toUpperCase();
        if(key === correctKey) {
            document.getElementById('activation-overlay').style.display = 'none';
            document.getElementById('app-content').style.display = 'block';
        }
    }

    function copyID() { navigator.clipboard.writeText(myID); alert("Device ID copied!"); }

    // --- CALCULATION LOGIC ---
    function showTab(e, id) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        e.currentTarget.classList.add('active');
    }

    function toggleTheme() { document.body.hasAttribute('data-theme') ? document.body.removeAttribute('data-theme') : document.body.setAttribute('data-theme', 'dark'); }

    function calcOhm() {
        let type = document.getElementById('o_type').value;
        let v1 = parseFloat(document.getElementById('o_v1').value) || 0;
        let v2 = parseFloat(document.getElementById('o_v2').value) || 0;
        let res = (type === 'v') ? v1 * v2 : v1 / v2;
        document.getElementById('res_ohm').innerText = "Result: " + res.toFixed(2);
    }

    function calcKVAR() {
        let p = parseFloat(document.getElementById('pf_kw').value) || 0;
        let pf1 = parseFloat(document.getElementById('pf_orig').value) || 0.75;
        let pf2 = parseFloat(document.getElementById('pf_target').value) || 0.95;
        let kvar = p * (Math.tan(Math.acos(pf1)) - Math.tan(Math.acos(pf2)));
        document.getElementById('res_pf').innerText = "Required: " + (isNaN(kvar) ? 0 : kvar.toFixed(2)) + " kVAR";
    }

    function calcLoad() {
        let ph = document.getElementById('l_ph').value;
        let w = parseFloat(document.getElementById('l_w').value) || 0;
        let pf = parseFloat(document.getElementById('l_pf').value) || 0.8;
        let amp = (ph == "1") ? (w / (230 * pf)) : (w / (400 * 1.732 * pf));
        let mcb = [6, 10, 16, 20, 25, 32, 40, 50, 63, 80, 100, 125, 160, 200, 250, 400].find(r => r > amp) || "MCCB";
        document.getElementById('res_load').innerHTML = `Current: ${amp.toFixed(2)} A<br>MCB: ${mcb}A`;
        document.getElementById('c_ib').value = amp.toFixed(2);
        document.getElementById('v_i').value = amp.toFixed(2);
    }

    function calcCable() {
        let ib = parseFloat(document.getElementById('c_ib').value) || 0;
        let f = parseFloat(document.getElementById('c_fact').value) || 1;
        let it = ib / f;
        const cableTable = [[1.5,14.5],[2.5,20],[4,26],[6,34],[10,46],[16,61],[25,80],[35,99],[50,119],[70,151],[95,182],[120,210],[150,240],[185,273],[240,321],[300,367]];
        let findSize = cableTable.find(r => r[1] >= it);
        document.getElementById('res_cable').innerText = "Size: " + (findSize ? findSize[0] + " mm¬≤" : "Large Size");
    }

    function calcVDrop() {
        let l = parseFloat(document.getElementById('v_l').value) || 0;
        let i = parseFloat(document.getElementById('v_i').value) || 0;
        let mv = parseFloat(document.getElementById('v_mv').value) || 0;
        document.getElementById('res_vdrop').innerText = "Drop: " + ((mv * i * l) / 1000).toFixed(2) + " V";
    }

    function calcEnergy() {
        let w = parseFloat(document.getElementById('en_w').value) || 0;
        let h = parseFloat(document.getElementById('en_h').value) || 0;
        let p = parseFloat(document.getElementById('en_price').value) || 0;
        let cost = (w * h * 30 / 1000) * p;
        document.getElementById('res_en').innerText = cost.toLocaleString() + " MMK / Month";
    }

    function calcEarth() {
        let p = parseFloat(document.getElementById('e_sr').value) || 0;
        let res = (p / (2 * 3.14 * 2.4)) * (Math.log((8 * 2.4) / 0.016) - 1);
        document.getElementById('res_earth').innerText = res.toFixed(2) + " Œ©";
    }

    function calcGen() {
        let kw = parseFloat(document.getElementById('g_kw').value) || 0;
        document.getElementById('res_gen').innerText = (kw / 0.8 * 1.25).toFixed(2) + " kVA";
    }
</script>
</body>
</html>

