
<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EKS Original - Electrical Ultimate Calc</title>
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/616/616494.png">
    <style>
        :root { --primary: #007AFF; --bg: #f2f2f7; --card: #ffffff; --text: #1c1c1e; --accent: #8e8e93; }
        [data-theme="dark"] { --bg: #000000; --card: #1c1c1e; --text: #ffffff; --accent: #8e8e93; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 30px; }
        .header { background: var(--card); padding: 15px; text-align: center; box-shadow: 0 1px 5px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; display: flex; justify-content: space-between; align-items: center; }
        .tabs { display: flex; overflow-x: auto; background: var(--card); padding: 10px; gap: 8px; border-bottom: 1px solid #ddd; scrollbar-width: none; }
        .tab-btn { padding: 8px 18px; border: none; background: #e5e5ea; border-radius: 15px; cursor: pointer; white-space: nowrap; font-weight: 600; font-size: 13px; }
        .tab-btn.active { background: var(--primary); color: white; }
        .container { padding: 15px; max-width: 650px; margin: auto; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s; }
        .card { background: var(--card); padding: 18px; border-radius: 14px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 15px; }
        h3 { margin: 0 0 15px 0; font-size: 15px; color: var(--primary); border-left: 4px solid var(--primary); padding-left: 10px; }
        label { display: block; margin-bottom: 5px; font-size: 12px; font-weight: 600; }
        input, select { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 8px; background: var(--bg); color: var(--text); box-sizing: border-box; }
        button { width: 100%; padding: 12px; border: none; border-radius: 8px; background: var(--primary); color: white; font-weight: bold; cursor: pointer; }
        .result-box { margin-top: 10px; padding: 12px; background: #007AFF10; border-radius: 8px; text-align: center; color: var(--primary); font-weight: bold; }
        .ref-info { font-size: 11px; color: var(--accent); margin-top: 5px; line-height: 1.4; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div class="header">
    <div style="width:30px"></div>
    <h2 style="font-size: 16px; margin:0;">‚ö° EKS ULTIMATE CALC</h2>
    <div onclick="toggleTheme()" style="cursor:pointer; font-size: 20px;">üåì</div>
</div>

<div class="tabs">
    <button class="tab-btn active" onclick="showTab(event, 'load')">Load & Breaker</button>
    <button class="tab-btn" onclick="showTab(event, 'cable')">Cable & Drop</button>
    <button class="tab-btn" onclick="showTab(event, 'earth')">Earth Rod</button>
    <button class="tab-btn" onclick="showTab(event, 'gen')">Gen & Light</button>
</div>

<div class="container">
    <div id="load" class="tab-content active">
        <div class="card">
            <h3>Load Current & Breaker Size</h3>
            <label>System Phase</label>
            <select id="l_ph"><option value="1">Single Phase (230V)</option><option value="3">Three Phase (400V)</option></select>
            <label>Total Power (Watts)</label>
            <input type="number" id="l_w" placeholder="e.g. 5000">
            <label>Demand Factor (0.1 - 1)</label>
            <input type="number" id="l_df" value="1" step="0.1">
            <label>Power Factor (CosœÜ)</label>
            <input type="number" id="l_pf" value="0.8">
            <button onclick="calcLoad()">Calculate Current</button>
            <div class="result-box" id="res_load">Load Current: 0 A<br>Suggested Breaker: -</div>
        </div>
    </div>

    <div id="cable" class="tab-content">
        <div class="card">
            <h3>Cable Selection (BS 7671)</h3>
            <label>Design Current (Ib) - Amps</label>
            <input type="number" id="c_ib" placeholder="Amps">
            <label>Ambient Temp Factor (Ca)</label>
            <input type="number" id="c_ca" value="1">
            <label>Grouping Factor (Cg)</label>
            <input type="number" id="c_cg" value="1">
            <button onclick="calcCable()">Find Tabulated Current</button>
            <div class="result-box" id="res_cable">It (Required): 0 A</div>
        </div>
        <div class="card">
            <h3>Voltage Drop (AC Method)</h3>
            <label>Current (A)</label>
            <input type="number" id="v_i" placeholder="A">
            <label>Length (Meters)</label>
            <input type="number" id="v_l" placeholder="M">
            <label>mV/A/m (from Catalogue)</label>
            <input type="number" id="v_mv" placeholder="e.g. 4.4">
            <button onclick="calcVDrop()">Check Drop</button>
            <div class="result-box" id="res_vdrop">Drop: 0 V</div>
        </div>
    </div>

    <div id="earth" class="tab-content">
        <div class="card">
            <h3>Earth Rod Resistance</h3>
            <label>Soil Resistivity (Œ©-m)</label>
            <input type="number" id="e_sr" placeholder="e.g. 100">
            <label>Rod Length (m)</label>
            <input type="number" id="e_l" value="2.4">
            <label>Rod Diameter (m)</label>
            <input type="number" id="e_d" value="0.016">
            <button onclick="calcEarth()">Find Resistance</button>
            <div class="result-box" id="res_earth">Single Rod: 0 Œ©</div>
            <div class="ref-info">Formula: (œÅ/2œÄL) * [ln(8L/d) - 1]</div>
        </div>
    </div>

    <div id="gen" class="tab-content">
        <div class="card">
            <h3>Generator Sizing</h3>
            <label>Total Load (kW)</label>
            <input type="number" id="g_kw" placeholder="kW">
            <label>Safety Factor (25% = 1.25)</label>
            <input type="number" id="g_sf" value="1.25">
            <button onclick="calcGen()">Find Gen Size (kVA)</button>
            <div class="result-box" id="res_gen">Required Gen: 0 kVA</div>
        </div>
        <div class="card">
            <h3>Lighting Calculation</h3>
            <label>Target Lux (E)</label>
            <input type="number" id="li_e" placeholder="e.g. 500">
            <label>Area (L x W)</label>
            <div style="display:flex; gap:5px;">
                <input type="number" id="li_l" placeholder="Length">
                <input type="number" id="li_w" placeholder="Width">
            </div>
            <label>UF (0.1-1) & MF (0.1-1)</label>
            <div style="display:flex; gap:5px;">
                <input type="number" id="li_uf" value="0.6" step="0.1">
                <input type="number" id="li_mf" value="0.8" step="0.1">
            </div>
            <button onclick="calcLight()">Total Lumens Needed</button>
            <div class="result-box" id="res_light">Total: 0 Lumens</div>
        </div>
    </div>
</div>

<script>
    function showTab(e, id) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        e.currentTarget.classList.add('active');
    }

    function toggleTheme() {
        document.body.hasAttribute('data-theme') ? document.body.removeAttribute('data-theme') : document.body.setAttribute('data-theme', 'dark');
    }

    function calcLoad() {
        let ph = document.getElementById('l_ph').value;
        let w = parseFloat(document.getElementById('l_w').value) || 0;
        let df = parseFloat(document.getElementById('l_df').value) || 1;
        let pf = parseFloat(document.getElementById('l_pf').value) || 0.8;
        let dLoad = w * df;
        let amp = (ph == "1") ? (dLoad / (230 * pf)) : (dLoad / (400 * 1.732 * pf));
        
        let mcb = "Not found";
        let ratings = [6, 10, 16, 20, 25, 32, 40, 50, 63, 80, 100, 125, 160, 200, 250, 400];
        for(let r of ratings) { if(r > amp) { mcb = r + "A"; break; } }
        
        document.getElementById('res_load').innerHTML = `Load Current: ${amp.toFixed(2)} A<br>MCB/MCCB Size: ${mcb}`;
    }

    function calcCable() {
        let ib = parseFloat(document.getElementById('c_ib').value) || 0;
        let ca = parseFloat(document.getElementById('c_ca').value) || 1;
        let cg = parseFloat(document.getElementById('c_cg').value) || 1;
        let it = ib / (ca * cg);
        document.getElementById('res_cable').innerText = "It (Tabulated Current): " + it.toFixed(2) + " A";
    }

    function calcVDrop() {
        let i = parseFloat(document.getElementById('v_i').value) || 0;
        let l = parseFloat(document.getElementById('v_l').value) || 0;
        let mv = parseFloat(document.getElementById('v_mv').value) || 0;
        let drop = (mv * i * l) / 1000;
        document.getElementById('res_vdrop').innerText = "Voltage Drop: " + drop.toFixed(2) + " V";
    }

    function calcEarth() {
        let p = parseFloat(document.getElementById('e_sr').value) || 0;
        let l = parseFloat(document.getElementById('e_l').value) || 1;
        let d = parseFloat(document.getElementById('e_d').value) || 0.01;
        let res = (p / (2 * 3.1415 * l)) * (Math.log((8 * l) / d) - 1);
        document.getElementById('res_earth').innerText = "Single Rod: " + res.toFixed(2) + " Œ©";
    }

    function calcGen() {
        let kw = parseFloat(document.getElementById('g_kw').value) || 0;
        let sf = parseFloat(document.getElementById('g_sf').value) || 1.25;
        let kva = (kw / 0.8) * sf;
        document.getElementById('res_gen').innerText = "Required Gen: " + kva.toFixed(2) + " kVA";
    }

    function calcLight() {
        let e = parseFloat(document.getElementById('li_e').value) || 0;
        let l = parseFloat(document.getElementById('li_l').value) || 0;
        let w = parseFloat(document.getElementById('li_w').value) || 0;
        let uf = parseFloat(document.getElementById('li_uf').value) || 1;
        let mf = parseFloat(document.getElementById('li_mf').value) || 1;
        let lumens = (e * l * w) / (uf * mf);
        document.getElementById('res_light').innerText = "Total: " + Math.round(lumens) + " Lumens";
    }
</script>

</body>
</html>

